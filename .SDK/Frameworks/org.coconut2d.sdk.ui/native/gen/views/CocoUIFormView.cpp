/* Generated by Coconut2D C++ Compiler from file CocoUIFormView.jspp */

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include "CocoUIFormView.hpp"
#include "CocoUIControl.hpp"
#include "CocoClip.hpp"
#include "CocoImage.hpp"
#include "HTMLWindow.hpp"

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////////////////////////
CocoUIFormView::CocoUIFormView(String Name)
{
	__instanceName = Name;
	__textureIsInvalid = false;
	__inlineControls = new Array<CocoUIControl*> ();
	__floatingControls = new Array<CocoUIControl*> ();
	__width = ((float)window->innerWidth);
	__height = ((float)window->innerHeight);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
CocoUIFormView::~CocoUIFormView()
{
	if(__inlineControls)
	{
		__inlineControls = (delete __inlineControls, nullptr);
	}
	if(__floatingControls)
	{
		__floatingControls = (delete __floatingControls, nullptr);
	}
}

////////////////////////////////////////////////////////////////////////////////////////////////////
void CocoUIFormView::invalidate()
{
	__textureIsInvalid = false;
}

////////////////////////////////////////////////////////////////////////////////////////////////////
CocoClip* CocoUIFormView::addInlineControl(CocoUIControl* ctl)
{
	if(ctl->__get_Height() == 0)
	{
		ctl->__set_Height((ctl->__get_SkinImage() ? ctl->__get_SkinImage()->textureCellHeight : 64));
	}
	if(ctl->__get_Width() == 0)
	{
		ctl->__set_Width(this->__get_Width() - ctl->__get_MarginLeft() - ctl->__get_MarginRight());
	}
	ctl->move(ctl->__get_MarginLeft(), inlineHeight() + ctl->__get_MarginTop(), ctl->__get_Width(), ctl->__get_Height());
	__inlineControls->push(ctl);
	return CocoUIView::addChild(ctl);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
float CocoUIFormView::inlineHeight()
{
	float h = 0;
	CocoUIControl* ctl;
	for(int i = __inlineControls->size(); i--;)
	{
		ctl = (*__inlineControls)[i];
		h += ctl->__get_MarginTop() + ctl->__get_Height() + ctl->__get_MarginBottom();
	}
	return h;
}

////////////////////////////////////////////////////////////////////////////////////////////////////
CocoClip* CocoUIFormView::addFloatingControl(CocoUIControl* ctl)
{
	__floatingControls->push(ctl);
	return CocoUIView::addChild(ctl);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
void CocoUIFormView::repaint(CocoScene* scene, CocoClip* parentClip, HTMLCanvasElement* canvas)
{
}
